import{u as E,R as e,A as ee,T as te,I as A,d as ne,a as d,r as i,B as ae,b as L,c as re,e as se,f as le,g as x,h as oe,M as ce,i as B,j as v,k as ie,l as _,C as ue,m as me,n as U,o as fe,p as b,L as K,q as pe,s as Ee,t as de,v as ge,P as M,w as g,x as $,y as I,z as D,D as he,S as xe,E as y,F as ve,G as ye,H as ke,J as Ne,K as we}from"./vendor.2deddc03.js";const be=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function a(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=a(r);fetch(r.href,l)}};be();function H({title:t,back:n}){const a=E();return e.createElement(ee,{position:"static"},e.createElement(te,null,n&&e.createElement(A,{edge:"start","aria-label":"back",onClick:()=>{typeof n=="string"||n instanceof String?a.push(n):a.goBack()}},e.createElement(ne,null)),e.createElement(d,{variant:"h6",className:"cursor-pointer",onClick:()=>a.push("/")},t!=null?t:"Homital")))}function Te({index:t}){const n=E(),[a,o]=i.exports.useState(t!=null?t:0),r=l=>{switch(o(l),l){case 0:n.push("/");break;case 1:n.push("/user");break}};return e.createElement(ae,{value:a,onChange:(l,u)=>{r(u)},showLabels:!0},e.createElement(L,{label:"Home",icon:e.createElement(re,null)}),e.createElement(L,{label:"User",icon:e.createElement(se,null)}))}function O({children:t,index:n,title:a,back:o,className:r}){return e.createElement("div",{className:"w-screen h-screen flex flex-col"},e.createElement(H,{title:a,back:o}),e.createElement("main",{className:`flex-1 bg-green-50 overflow-y-auto ${r}`},t),e.createElement(Te,{index:n!=null?n:0}))}function Se(){const[t,n]=i.exports.useState(0),[a,o]=i.exports.useState(null),r=f=>{o(f.currentTarget)},l=()=>{o(null)},u=(f,m)=>{n(m)};return e.createElement("div",null,e.createElement("div",{className:"flex flex-row"},e.createElement(le,{value:t,onChange:u,indicatorColor:"primary",textColor:"primary",variant:"scrollable",className:"flex-grow-0 flex-shrink"},e.createElement(x,{label:"Favorite"}),e.createElement(x,{label:"Living Room"}),e.createElement(x,{label:"Bedroom"}),e.createElement(x,{label:"Corridor"}),e.createElement(x,{label:"Restroom"})),e.createElement("div",{className:"flex-1"}),e.createElement(A,{"aria-label":"menu",className:"text-gray-600 py-0 pr-0 pl-2",onClick:r},e.createElement(oe,null)),e.createElement(ce,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:l},e.createElement(B,{onClick:l},"Manage Rooms"),e.createElement(B,{onClick:l},"All Devices"))))}function Re(){const t=v(a=>a.account.refreshToken),n=E();return i.exports.useEffect(()=>{t||n.push("/user")},[t]),e.createElement(O,{index:0,className:"flex flex-col"},t?e.createElement("div",{className:"pt-2 px-2"},e.createElement(Se,null)):e.createElement("div",{className:"flex-1 flex flex-row items-center"},e.createElement("p",{className:"flex-1 text-center text-gray-300"},"Home")))}const z=t=>{if(typeof window!="undefined"&&window.localStorage){const n=localStorage.getItem(t);return n?JSON.parse(n):null}return null},k=(t,n)=>(typeof window!="undefined"&&window.localStorage&&localStorage.setItem(t,JSON.stringify(n)),null);var G,q;const F=ie({name:"account",initialState:{refreshToken:(G=z("refreshToken"))!=null?G:"",accessToken:"",username:(q=z("username"))!=null?q:""},reducers:{setRefreshToken:(t,n)=>{const{token:a}=n.payload;t.refreshToken=a,k("refreshToken",a)},setAccessToken:(t,n)=>{const{token:a}=n.payload;t.accessToken=a},setUsername:(t,n)=>{const{username:a}=n.payload;t.username=a,k("username",a)},login:(t,n)=>{const{username:a,refreshToken:o,accessToken:r}=n.payload;t.username=a,t.refreshToken=o,t.accessToken=r,k("username",a),k("refreshToken",o)},reset:t=>{t.refreshToken="",t.accessToken="",t.username="",k("refreshToken","")}}}),{setRefreshToken:Ge,setAccessToken:qe,setUsername:Ve,login:Ce,reset:Pe}=F.actions;var $e=F.reducer;function Ie(){const t=v(r=>r.account.refreshToken),n=v(r=>r.account.username),a=_(),o=()=>{a(Pe())};return e.createElement(ue,{elevation:0,className:"flex flex-row min-h-32 bg-transparent"},e.createElement("div",{className:"w-32 flex flex-row justify-center content-center"},e.createElement("div",{className:"flex flex-col justify-center content-center"},e.createElement(me,{className:`w-24 h-24 ${t?"text-gray-600":"text-gray-300"}`}))),e.createElement("div",{className:"flex-1 flex flex-col"},t?e.createElement(e.Fragment,null,e.createElement(U,{className:"flex flex-col mt-4 pb-0"},e.createElement(d,{component:"h4",variant:"h4",className:"mb-2"},n),e.createElement(d,{component:"p",variant:"body1"},"Welcome!")),e.createElement(fe,{className:"self-stretch flex flex-row-reverse"},e.createElement(b,{variant:"outlined",size:"small",className:"text-pink-700",onClick:r=>{r.preventDefault(),o()}},"Log Out"))):e.createElement(U,{className:"mt-4"},e.createElement(d,{component:"h5",variant:"h5"},"Please"," ",e.createElement(K,{to:"/login",className:"text-indigo-700 underline"},"login")))))}function J({title:t,icon:n,link:a}){const o=E(),r=()=>{o.push(a)};return e.createElement("div",{className:"flex flex-row content-center px-6 py-6 focus:bg-gray-100 hover:bg-gray-100 hover:cursor-pointer",role:"link",tabIndex:0,onClick:l=>{l.preventDefault(),l.stopPropagation(),r()},onKeyPress:l=>{l.key==="Enter"&&(l.preventDefault(),l.stopPropagation(),r())}},n,e.createElement("span",{className:"text-lg ml-4"},t))}function De(){return e.createElement("div",{className:"flex flex-col min-h-32 bg-white shadow-xl rounded-xl"},e.createElement(J,{title:"Settings",icon:e.createElement(pe,{className:"mt-0.5"}),link:"/settings"}),e.createElement(J,{title:"About",icon:e.createElement(Ee,{className:"mt-0.5"}),link:"/about"}))}function Oe(){return e.createElement(O,{index:1,className:"flex flex-col"},e.createElement("div",{className:"px-4 h-40"},e.createElement(Ie,null)),e.createElement("div",{className:"p-4"},e.createElement(De,null)),e.createElement("div",{className:"flex-1 flex flex-row items-center"},e.createElement("p",{className:"flex-1 text-center text-gray-300"},"User")))}function j({children:t,title:n,className:a,back:o}){return e.createElement("div",{className:"w-screen h-screen flex flex-col"},e.createElement(H,{title:n,back:o}),e.createElement("main",{className:`flex-1 bg-green-50 overflow-y-auto ${a}`},t))}var N=de({reducer:{account:$e}});const Ae="https://homital.herokuapp.com/api",w=ge.create({baseURL:Ae,timeout:1e4});N.getState().account.accessToken&&(w.defaults.headers.common.Authorization=`Bearer ${N.getState().account.accessToken}`);function Le(){const{accessToken:t}=N.getState().account;w.defaults.headers.common.Authorization=`Bearer ${t}`}N.subscribe(Le);async function Be({email:t}){return(await w.post("/auth/user/getotp",{email:t})).data}async function _e({email:t,username:n,password:a,otp:o}){return(await w.post("/auth/user/register",{email:t,username:n,password:a,otp:o})).data}async function W({email:t,username:n,password:a}){return(await w.post(`/auth/user/login?by=${n?"username":"email"}`,{email:t,username:n,password:a})).data}const Ue=async(t,n)=>{let a;return t.includes("@")?a=await W({email:t,password:n}):a=await W({username:t,password:n}),a};function Ke(){const t=v(c=>c.account.refreshToken),n=_(),a=E(),o=i.exports.useRef(null),r=i.exports.useRef(null),l=i.exports.useRef(null),[u,f]=i.exports.useState(""),[m,T]=i.exports.useState(""),[S,p]=i.exports.useState(null);i.exports.useEffect(()=>{t&&a.push("/user")},[]);const h=()=>{p(e.createElement($,{size:16,color:"inherit"})),Ue(u,m).then(c=>{n(Ce({username:u,refreshToken:c.refresh_token,accessToken:c.access_token})),p(e.createElement(I,null)),setTimeout(()=>{a.push("/")},500)}).catch(c=>{c.response&&(p(e.createElement(D,null)),console.log(`${c.response.status}: ${JSON.stringify(c.response.data)}`))})};return e.createElement(j,{title:"Login",back:!0,className:"flex place-items-center place-content-center"},e.createElement(M,{elevation:2,className:"px-8 py-8 min-w-2/4 max-w-3/4"},e.createElement(d,{component:"h5",variant:"h5",className:"mb-4"},"Login"),e.createElement("form",{className:"flex flex-col gap-4"},e.createElement(g,{label:"Username/Email",variant:"outlined",value:u,inputRef:o,onChange:c=>{c.preventDefault(),f(c.target.value)},onKeyPress:c=>{c.key==="Enter"&&(c.preventDefault(),r.current.focus())}}),e.createElement(g,{label:"Password",variant:"outlined",type:"password",value:m,inputRef:r,onChange:c=>{c.preventDefault(),T(c.target.value)},onKeyPress:c=>{c.key==="Enter"&&(c.preventDefault(),l.current.focus(),l.current.click())}}),e.createElement("div",{className:"flex flex-row"},e.createElement("div",{className:"w-1/2 pr-2"},e.createElement(b,{variant:"contained",color:"primary",className:"w-full",ref:l,endIcon:S,onClick:c=>{c.preventDefault(),c.stopPropagation(),h()}},"Login")),e.createElement("div",{className:"w-1/2 pl-2 flex flex-row-reverse"},e.createElement(K,{to:"/register",className:"text-indigo-700 underline pt-1"},"Register"))))))}const Me=async t=>await Be({email:t}),He=async(t,n,a,o)=>await _e({email:t,otp:n,username:a,password:o});function ze(){const t=v(s=>s.account.refreshToken),n=E(),a=i.exports.useRef(null),o=i.exports.useRef(null),r=i.exports.useRef(null),l=i.exports.useRef(null),u=i.exports.useRef(null),f=i.exports.useRef(null),[m,T]=i.exports.useState(""),[S,p]=i.exports.useState(null),[h,c]=i.exports.useState(""),[R,V]=i.exports.useState(""),[C,Q]=i.exports.useState(""),[X,P]=i.exports.useState(null);i.exports.useEffect(()=>{t&&n.push("/user")},[t]);const Y=()=>{p(e.createElement($,{size:16,color:"inherit"})),Me(m).then(()=>{p(e.createElement(I,null)),r.current.focus()}).catch(s=>{s.response&&(p(e.createElement(D,null)),console.log(`${s.response.status}: ${JSON.stringify(s.response.data)}`))})},Z=()=>{console.log(`Register with ${m}:${h}:${R}:${C}`),P(e.createElement($,{size:16,color:"inherit"})),He(m,h,R,C).then(()=>{P(e.createElement(I,null)),setTimeout(()=>{n.goBack()},500)}).catch(s=>{s.response&&(P(e.createElement(D,null)),console.log(`${s.response.status}: ${JSON.stringify(s.response.data)}`))})};return e.createElement(j,{title:"Register",back:!0,className:"flex place-items-center place-content-center"},e.createElement(M,{elevation:2,className:"px-8 py-8 min-w-2/4 max-w-3/4"},e.createElement(d,{component:"h5",variant:"h5",className:"mb-4"},"Register"),e.createElement("form",{className:"flex flex-col gap-4"},e.createElement(g,{label:"Email",variant:"outlined",value:m,inputRef:a,onChange:s=>{s.preventDefault(),T(s.target.value)},onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),o.current.focus())}}),e.createElement(b,{variant:"contained",color:"secondary",className:"w-full",ref:o,endIcon:S,onClick:s=>{s.preventDefault(),s.stopPropagation(),Y()}},"Get OTP"),e.createElement(g,{label:"OTP",variant:"outlined",value:h,inputRef:r,onChange:s=>{s.preventDefault(),c(s.target.value)},onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),l.current.focus())}}),e.createElement(g,{label:"Username",variant:"outlined",value:R,inputRef:l,onChange:s=>{s.preventDefault(),V(s.target.value)},onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),u.current.focus())}}),e.createElement(g,{label:"Password",variant:"outlined",type:"password",value:C,inputRef:u,onChange:s=>{s.preventDefault(),Q(s.target.value)},onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),f.current.focus(),f.current.click())}}),e.createElement(b,{variant:"contained",color:"primary",className:"w-full",ref:f,endIcon:X,onClick:s=>{s.preventDefault(),s.stopPropagation(),Z()}},"Register"))))}function Fe(){return e.createElement(O,{index:-1,className:"flex"},e.createElement("p",{className:"flex-1 place-self-center text-center text-gray-300"},"Not Found"))}function Je(){return e.createElement(he,null,e.createElement(xe,null,e.createElement(y,{path:"/",exact:!0},e.createElement(Re,null)),e.createElement(y,{path:"/user"},e.createElement(Oe,null)),e.createElement(y,{path:"/login"},e.createElement(Ke,null)),e.createElement(y,{path:"/register"},e.createElement(ze,null)),e.createElement(y,{path:"*"},e.createElement(Fe,null))))}const je=ve({palette:{primary:{light:"#66ffa6",main:"#00e676",dark:"#00b248",contrastText:"#4e342e"},secondary:{light:"#b2fef7",main:"#80cbc4",dark:"#4f9a94",contrastText:"#6d4c41"}}});ye.render(e.createElement(e.StrictMode,null,e.createElement(ke,{store:N},e.createElement(Ne,{theme:je},e.createElement(we,null,e.createElement("meta",{charSet:"utf-8"}),e.createElement("title",null,"Homital")),e.createElement(Je,null)))),document.getElementById("root"));
