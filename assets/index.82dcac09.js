var e,t;import{u as a,R as n,A as r,T as s,I as l,d as c,a as o,r as u,B as m,b as i,c as f,e as p,f as E,g as x,h as d,C as h,i as g,j as v,k,l as w,L as y,m as N,n as b,P as T,o as R,p as S,q as D,s as P,t as C,S as $,v as O,w as L,x as U,y as B,z as K}from"./vendor.c86e7048.js";function A({title:e,back:t}){const u=a();return n.createElement(r,{position:"static"},n.createElement(s,null,t&&n.createElement(l,{edge:"start","aria-label":"back",onClick:()=>{"string"==typeof t||t instanceof String?u.push(t):u.goBack()}},n.createElement(c,null)),n.createElement(o,{variant:"h6",className:"cursor-pointer",onClick:()=>u.push("/")},null!=e?e:"Homital")))}function I({index:e}){const t=a(),[r,s]=u.exports.useState(null!=e?e:0);return n.createElement(m,{value:r,onChange:(e,a)=>{(e=>{switch(s(e),e){case 0:t.push("/");break;case 1:t.push("/user")}})(a)},showLabels:!0},n.createElement(i,{label:"Home",icon:n.createElement(f,null)}),n.createElement(i,{label:"User",icon:n.createElement(p,null)}))}function J({children:e,index:t,title:a,back:r,className:s}){return n.createElement("div",{className:"w-screen h-screen flex flex-col"},n.createElement(A,{title:a,back:r}),n.createElement("main",{className:`flex-1 bg-green-50 overflow-y-auto ${s}`},e),n.createElement(I,{index:null!=t?t:0}))}function j(){const e=E((e=>e.account.refreshToken)),t=a();return u.exports.useEffect((()=>{e||t.push("/user")}),[e]),n.createElement(J,{index:0,className:"flex flex-col"},n.createElement("div",{className:"flex-1 flex flex-row items-center"},n.createElement("p",{className:"flex-1 text-center text-gray-300"},"Home")))}const z=e=>{if("undefined"!=typeof window&&window.localStorage){const t=localStorage.getItem(e);return t?JSON.parse(t):null}return null},H=(e,t)=>("undefined"!=typeof window&&window.localStorage&&localStorage.setItem(e,JSON.stringify(t)),null),F=x({name:"account",initialState:{refreshToken:null!=(e=z("refreshToken"))?e:"",accessToken:"",username:null!=(t=z("username"))?t:""},reducers:{setRefreshToken:(e,t)=>{const{token:a}=t.payload;e.refreshToken=a,H("refreshToken",a)},setAccessToken:(e,t)=>{const{token:a}=t.payload;e.accessToken=a},setUsername:(e,t)=>{const{username:a}=t.payload;e.username=a,H("username",a)},login:(e,t)=>{const{username:a,refreshToken:n,accessToken:r}=t.payload;e.username=a,e.refreshToken=n,e.accessToken=r,H("username",a),H("refreshToken",n)},reset:e=>{e.refreshToken="",e.accessToken="",e.username="",H("refreshToken","")}}}),{setRefreshToken:_,setAccessToken:q,setUsername:G,login:M,reset:W}=F.actions;function Q(){const e=E((e=>e.account.refreshToken)),t=E((e=>e.account.username)),a=d();return n.createElement(h,{elevation:4,className:"flex flex-row min-h-32"},n.createElement("div",{className:"w-32 flex flex-row justify-center content-center"},n.createElement("div",{className:"flex flex-col justify-center content-center"},n.createElement(g,{className:"w-24 h-24 "+(e?"text-gray-600":"text-gray-300")}))),n.createElement("div",{className:"flex-1 flex flex-col"},e?n.createElement(n.Fragment,null,n.createElement(v,{className:"flex flex-col gap-4"},n.createElement(o,{component:"h5",variant:"h5"},t),n.createElement(o,{component:"p",variant:"body1"},"Welcome!")),n.createElement(k,{className:"self-stretch flex flex-row-reverse"},n.createElement(w,{variant:"contained",size:"small",color:"secondary",onClick:e=>{e.preventDefault(),a(W())}},"Log Out"))):n.createElement(v,null,n.createElement(o,{component:"h5",variant:"h5"},"Please"," ",n.createElement(y,{to:"/login",className:"text-indigo-700 underline"},"login")))))}function V(){return n.createElement(J,{index:1,className:"flex flex-col"},n.createElement("div",{className:"p-4"},n.createElement(Q,null)),n.createElement("div",{className:"flex-1 flex flex-row items-center"},n.createElement("p",{className:"flex-1 text-center text-gray-300"},"User")))}function X({children:e,title:t,className:a,back:r}){return n.createElement("div",{className:"w-screen h-screen flex flex-col"},n.createElement(A,{title:t,back:r}),n.createElement("main",{className:`flex-1 bg-green-50 overflow-y-auto ${a}`},e))}var Y=N({reducer:{account:F.reducer}});const Z=b.create({baseURL:"https://homital.herokuapp.com/api",timeout:1e4});async function ee({email:e,username:t,password:a}){return(await Z.post("/auth/user/login?by="+(t?"username":"email"),{email:e,username:t,password:a})).data}Y.getState().account.accessToken&&(Z.defaults.headers.common.Authorization=`Bearer ${Y.getState().account.accessToken}`),Y.subscribe((function(){const{accessToken:e}=Y.getState().account;Z.defaults.headers.common.Authorization=`Bearer ${e}`}));function te(){const e=E((e=>e.account.refreshToken)),t=d(),r=a(),s=u.exports.useRef(null),l=u.exports.useRef(null),c=u.exports.useRef(null),[m,i]=u.exports.useState(""),[f,p]=u.exports.useState("");u.exports.useEffect((()=>{e&&r.push("/user")}),[e]);const x=()=>{(async(e,t)=>{let a;return a=e.includes("@")?await ee({email:e,password:t}):await ee({username:e,password:t}),a})(m,f).then((e=>{t(M({username:m,refreshToken:e.refresh_token,accessToken:e.access_token})),r.push("/user")})).catch((e=>{e.response&&console.log(`${e.response.status}: ${JSON.stringify(e.response.data)}`)}))};return n.createElement(X,{title:"Login",back:!0,className:"flex place-items-center place-content-center"},n.createElement(T,{elevation:2,className:"px-8 py-8 min-w-2/4 max-w-3/4"},n.createElement(o,{component:"h5",variant:"h5",className:"mb-4"},"Login"),n.createElement("form",{className:"flex flex-col gap-4"},n.createElement(R,{label:"Username/Email",variant:"outlined",value:m,inputRef:s,onChange:e=>{e.preventDefault(),i(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),l.current.focus())}}),n.createElement(R,{label:"Password",variant:"outlined",type:"password",value:f,inputRef:l,onChange:e=>{e.preventDefault(),p(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),c.current.focus(),c.current.click())}}),n.createElement("div",{className:"flex flex-row"},n.createElement("div",{className:"w-1/2 pr-2"},n.createElement(w,{variant:"contained",color:"primary",className:"w-full",ref:c,onClick:e=>{e.preventDefault(),e.stopPropagation(),x()}},"Login")),n.createElement("div",{className:"w-1/2 pl-2 flex flex-row-reverse"},n.createElement(y,{to:"/register",className:"text-indigo-700 underline pt-1"},"Register"))))))}const ae=async e=>await async function({email:e}){return(await Z.post("/auth/user/getotp",{email:e})).data}({email:e}),ne=async(e,t,a,n)=>await async function({email:e,username:t,password:a,otp:n}){return(await Z.post("/auth/user/register",{email:e,username:t,password:a,otp:n})).data}({email:e,otp:t,username:a,password:n});function re(){const e=E((e=>e.account.refreshToken)),t=a(),r=u.exports.useRef(null),s=u.exports.useRef(null),l=u.exports.useRef(null),c=u.exports.useRef(null),m=u.exports.useRef(null),i=u.exports.useRef(null),[f,p]=u.exports.useState(""),[x,d]=u.exports.useState(null),[h,g]=u.exports.useState(""),[v,k]=u.exports.useState(""),[y,N]=u.exports.useState("");u.exports.useEffect((()=>{e&&t.push("/user")}),[e]);return n.createElement(X,{title:"Register",back:!0,className:"flex place-items-center place-content-center"},n.createElement(T,{elevation:2,className:"px-8 py-8 min-w-2/4 max-w-3/4"},n.createElement(o,{component:"h5",variant:"h5",className:"mb-4"},"Register"),n.createElement("form",{className:"flex flex-col gap-4"},n.createElement(R,{label:"Email",variant:"outlined",value:f,inputRef:r,onChange:e=>{e.preventDefault(),p(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),s.current.focus())}}),n.createElement(w,{variant:"contained",color:"secondary",className:"w-full",ref:s,endIcon:x,onClick:e=>{e.preventDefault(),e.stopPropagation(),d(n.createElement(S,null)),ae(f).then((()=>{d(n.createElement(D,null)),l.current.focus()})).catch((e=>{e.response&&(d(n.createElement(P,null)),console.log(`${e.response.status}: ${JSON.stringify(e.response.data)}`))}))}},"Get OTP"),n.createElement(R,{label:"OTP",variant:"outlined",value:h,inputRef:l,onChange:e=>{e.preventDefault(),g(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),c.current.focus())}}),n.createElement(R,{label:"Username",variant:"outlined",value:v,inputRef:c,onChange:e=>{e.preventDefault(),k(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),m.current.focus())}}),n.createElement(R,{label:"Password",variant:"outlined",type:"password",value:y,inputRef:m,onChange:e=>{e.preventDefault(),N(e.target.value)},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),i.current.focus(),i.current.click())}}),n.createElement(w,{variant:"contained",color:"primary",className:"w-full",ref:i,onClick:e=>{e.preventDefault(),e.stopPropagation(),console.log(`Register with ${f}:${h}:${v}:${y}`),ne(f,h,v,y).then((()=>{t.goBack()})).catch((e=>{e.response&&console.log(`${e.response.status}: ${JSON.stringify(e.response.data)}`)}))}},"Register"))))}function se(){return n.createElement(J,{index:-1,className:"flex"},n.createElement("p",{className:"flex-1 place-self-center text-center text-gray-300"},"Not Found"))}function le(){return n.createElement(C,null,n.createElement($,null,n.createElement(O,{path:"/",exact:!0},n.createElement(j,null)),n.createElement(O,{path:"/user"},n.createElement(V,null)),n.createElement(O,{path:"/login"},n.createElement(te,null)),n.createElement(O,{path:"/register"},n.createElement(re,null)),n.createElement(O,{path:"*"},n.createElement(se,null))))}const ce=L({palette:{primary:{light:"#66ffa6",main:"#00e676",dark:"#00b248",contrastText:"#4e342e"},secondary:{light:"#b2fef7",main:"#80cbc4",dark:"#4f9a94",contrastText:"#6d4c41"}}});U.render(n.createElement(n.StrictMode,null,n.createElement(B,{store:Y},n.createElement(K,{theme:ce},n.createElement(le,null)))),document.getElementById("root"));
